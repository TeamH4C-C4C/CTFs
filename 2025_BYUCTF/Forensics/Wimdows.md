# Wimdows 1

이번 주 초, 공격자가 우리 Windows 서버 중 하나에 침입했습니다... 무슨 일이 일어났는지 알아내는 데 도움을 주실 수 있나요? 이 챌린지의 VM 파일은 아래에 있습니다 (자격 증명은 vagrant/vagrant입니다):

https://byu.box.com/v/byuctf-wimdows

공격자가 머신에 셸을 얻기 위해 어떤 CVE를 악용했습니까? 답변을 byuctf{}로 감싸십시오. 예: byuctf{CVE-2021-38759}

힌트: 공격자가 악용한 프로세스를 알아내고 그와 관련된 취약점을 찾아보세요.

# 풀이

`elasticsearch-service-x64.exe` 이거 검색하니까 CVE가 나왔고, 깃허브에 있는 거 하나씩 넣어보니 답이 나왔습니다.

flag: `byuctf{CVE-2014-3120}`

# Wimdows 2

이 챌린지는 Windows 1과 동일한 파일을 사용합니다.

공격자가 침투한 후, 그들은 시스템에서 몇 가지 명령을 실행했지만, 자신들의 행동을 숨기려 했던 것으로 보입니다. 거기서 흥미로운 점을 찾을 수 있는지 확인해 보세요 (답변은 이미 byuctf{} 형식으로 되어 있을 것입니다).

# 풀이

VM에 있는 이벤트 로그를 뒤져보면 파워쉘을 base64인코딩으로 실행한 흔적이 있고 디코딩 해보면 뒤에 플래그가 붙어있었습니다.

flag: `byuctf{n0w_th4t5_s0m3_5u5_l00k1ng_p0w3rsh3ll_139123}`

# Wimdows 3

이 문제는 Wimdows 1과 동일한 파일을 사용합니다.

공격자는 새 계정도 생성했는데, 이 계정을 어떤 그룹에 추가했습니까? 답을 `byuctf{}`로 묶으세요. 예: `byuctf{CTF Players}`.

*알림 - 이 모든 문제의 답은 대소문자를 구분하지 않습니다*

# 풀이

이것도 이벤트로그에 이벤트ID로 필터를 걸어서 보면 나옵니다.

flag: `byuctf{Remote Desktop Users}`

# Wimdows 4

이 문제는 Wimdows 1과 동일한 파일을 사용합니다.

공격자는 접근 권한을 이용하여 해당 시스템에 C2 바이너리를 배포했습니다. 어떤 C2 프레임워크였고, C2가 연결을 시도한 IP 주소는 어디였습니까? 답변 형식을 `byuctf{<c2 framework>_<ip address>}`로 지정하세요. 예: `byuctf{evilosx_10.1.1.1}`

# 풀이

악성코드를 찾은 후 바이러스 토탈에 넣으니 c2 주소와 c2 프레임워크를 찾을 수 있었습니다.

flag :`byuctf{sliver_192.168.1.224}`

# Wimdows 5

이 챌린지는 Wimdows 1과 동일한 파일을 사용합니다.

마지막으로, 공격자는 시스템에 또 다른 백도어를 설치하여 시스템 권한을 획득했습니다... 그 백도어는 무엇이었을까요? (답은 `byuctf{}` 형식으로 제공됩니다.)

# 풀이

이것도 cmd.exe로 필터링 걸어서 찾다보니 플래그가 평문으로 나왔습니다.

flag : `byuctf{00p5_4ll_b4ckd00r5_139874}`